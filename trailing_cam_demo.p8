pico-8 cartridge // http://www.pico-8.com
version 41
__lua__
--init
function _init()
	--player
	p=new_e(64,64,0.1)
	p.maxv=2
	--camera
	c=new_e(64,64,0.09)
	c.maxv=10
end

function new_e(x,y,amax)
	e={}
	e.x=x--current position
	e.y=y
	e.fx=x--future position
	e.fy=y
	e.vx=0--velocity
	e.vy=0
	e.maxv=1
	e.ax=0--acceleration
	e.ay=0
	e.amax=amax--maximum acc.
	
	return e
end
-->8
--update	
function _update()
	--player steering
	player_input(p)
	
	--camera logic
	c.ax=get_a(c.x,c.vx,c.ax,c.amax,
												p.x,p.vx)
	c.ay=get_a(c.y,c.vy,c.ay,c.amax,
												p.y,p.vy)
	--move entities
	update_e(p)
	update_e(c)
end

function player_input(p)
	if btn(⬅️) then
		p.ax=-p.amax
	elseif btn(➡️) then
		p.ax=p.amax
	else
		p.ax=0
	end
	
	if btn(⬆️) then
		p.ay=-p.amax
	elseif btn(⬇️) then
		p.ay=p.amax
	else
		p.ay=0
	end
end

function update_e(e)
	e.vx+=e.ax
	e.vy+=e.ay
	local magv=sqrt(e.vx^2+e.vy^2)
	if magv>e.maxv then
		local r=e.maxv/magv
		e.vx*=r
		e.vy*=r
	end
	e.x +=e.vx
	e.y +=e.vy
end
-->8
--draw
function _draw()
	cls(0)
	ofs=64
	camera(c.x-ofs,c.y-ofs)
	map()
	rect(c.x-ofs,c.y-ofs,c.x+ofs-1,c.y+ofs-1,1)
	--draw camera
	--circ(c.x,c.y,1,5)
	--draw player
	--circ(p.x,p.y,1,7)
	local angle=atan2(p.vx,p.vy)
	local n=80--start sprite
	if angle>0.875+0.0625 or angle<0.0625 then
		spr(n+0,p.x,p.y)
	elseif angle>0.75+0.0625 then
		spr(n+1,p.x,p.y)
	elseif angle>0.625+0.0625 then
		spr(n+2,p.x,p.y)
	elseif angle>0.5+0.0625 then
		spr(n+3,p.x,p.y)
	elseif angle>0.375+0.0625 then
		spr(n+4,p.x,p.y)
	elseif angle>0.25+0.0625 then
		spr(n+5,p.x,p.y)
	elseif angle>0.125+0.0625 then
		spr(n+6,p.x,p.y)
	else
		spr(n+7,p.x,p.y)
	end
	
	local angle=atan2(p.ax,p.ay)

	local n=96--start sprite
	if angle>0.875+0.0625 or angle<0.0625 then
		spr(n+0,p.x,p.y)
	elseif angle>0.75+0.0625 then
		spr(n+1,p.x,p.y)
	elseif angle>0.625+0.0625 then
		spr(n+2,p.x,p.y)
	elseif angle>0.5+0.0625 then
		spr(n+3,p.x,p.y)
	elseif angle>0.375+0.0625 then
		spr(n+4,p.x,p.y)
	elseif angle>0.25+0.0625 then
		spr(n+5,p.x,p.y)
	elseif angle>0.125+0.0625 then
		spr(n+6,p.x,p.y)
	else
		spr(n+7,p.x,p.y)
	end
end
-->8
--misc
--future position
--position,velocity,acc,frames
function fp(x,v,a,t)
	return x+v*t+0.5*a*t^2
end

--gets acceleration to
--reach goal
function get_a(cx,cvx,ca,camax,
															px,pvx)
	t=flr(abs((cvx-pvx)/camax))
	cxf=fp(cx,cvx,-ca,t)
	pxf=px+pvx*t
	if cxf>pxf then
		ca=-camax
	elseif cxf<pxf then
		ca=camax
	else
		ca=0
	end
	return ca
end
__gfx__
00000000000000000000000000000000000000000066660000000000009949000000000000000000000000000000000000000000000000000000000000000000
00000000000000700000000000066000000660000666666000013000099999900000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000666600006666006666666600113300994999990000000000000000000000000000000000000000000000000000000000000000
00077000000000000070000000666600066666606666666600333300999949990000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000066000066666606666666600031000944999940000000000000000000000000000000000000000000000000000000000000000
00700700000000000000700000000000006666006666666600000000944999990000000000000000000000000000000000000000000000000000000000000000
00000000700000000000000000000000000660000666666000000000099994900000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000066660000000000009999000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000770000000700000000000000000000000000000070000000770000000000000000000000000000000000000000000000000000000000000000000
00777700000677000000670000770000000000000000770000760000007760000000000000000000000000000000000000000000000000000000000000000000
07677670000777700007770000777070000770000707770000777000077770000000000000000000000000000000000000000000000000000000000000000000
06077060007776700007770000677770070770700777760000777000076777000000000000000000000000000000000000000000000000000000000000000000
00066000007760600006670000067760067777600677600000766000060677000000000000000000000000000000000000000000000000000000000000000000
00000000006600000000760000077600006666000067700000670000000066000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000600000066000000000000006600000060000000000000000000000000000000000000000000000000000000000000000000000000000
0011100000aa1000000a0000001aa0000011100000111000001a1000001110000000000000000000000000000000000000000000000000000000000000000000
0aa001000aaa01000aaaaa00010aaa000100aa000a000100010a010001000a000000000000000000000000000000000000000000000000000000000000000000
0aaa0010aaaa00101aaaaa10100aaaa0100aaa0010a00010100a00101000a0100000000000000000000000000000000000000000000000000000000000000000
aaaaaaa0aaaa001010aaa010100aaaa0aaaaaaa0100aaaa010aaa010aaaa00100000000000000000000000000000000000000000000000000000000000000000
0aaa00101000a010100a001010a00010100aaa00100aaaa01aaaaa10aaaa00100000000000000000000000000000000000000000000000000000000000000000
0aa0010001000a00010a01000a0001000100aa00010aaa000aaaaa000aaa01000000000000000000000000000000000000000000000000000000000000000000
0011100000111000001a10000011100000111000001aa000000a000000aa10000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000030000000333000000030000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000300000000060000000003000000000000000000000000000000000000000000000000000000000000000000
00000030000000000000000000000000300000003060000000000000000060300000000000000000000000000000000000000000000000000000000000000000
00000630000000000000000000000000360000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000030000060300000000030600000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000003000006000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000030000033300000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000200000000000000000000000000000000000000000000000000010100000000010000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000
00000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
60006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000600000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000
00006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000001010000000000000000000000000000000000000000000
00000070001000100010001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000
00000010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000002000000000000000000000000000000000000000000000000000001010001010000000000000000000101000000000002000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000101000000000000000000000000000100000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000003000000000000000000000000000000000005000000000000000000000000000000000000000200000000000000000000000500000
00000000000000002000000020002020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000100000000000000000000000000000000000000000000060000000000000000000000000000000000000000000
00000000200040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
50003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000070000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000002020000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000700000000000500000000000000000002000000000
00000050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000070000030000000700000000000000000000000000020000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000200000000000000000000000000000000000000000006000000000000000000000000000002000000000003000000000000000000000002040
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000005000102010000000000000000000000010101010000051
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000007000000000100000003000000000000010001000000000000000
20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000010100010000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000010000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000
__map__
0002020000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000020200000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000202000000000302020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0004000000020000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000003000002020000020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0002000000000000000002020000000000000000000000040000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000040000000000000000000000000001000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000400000200000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000040000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000010100000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000001000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000020000000000000000000000000001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000020000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000002000000000000000000030002020000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000003000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000002000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

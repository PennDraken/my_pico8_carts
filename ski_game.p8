pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
function _init()
	music(0)
	_set_fps(60)
end

--player variables
player_maxspeed = 2
player_turnspeed = player_maxspeed/2
player_speed = player_maxspeed
player_n = 64
player_x = 128/2+4
player_y = 30
player_crash = false

--obstacles
function new_o(n, x, y)
	o   = {}
	o.n = n
	o.x = x
	o.y = y
	
	return o
end

o_list = {}



-->8
--draw game
function _draw()
	draw_game()
end

function draw_game()
	cls()
	--spr(1)
	draw_bg()
	draw_player()
	draw_obstacles()
end

bg_id={0,1,2}
ofs=0
function draw_bg()
	ofs = (ofs - player_speed)%8
	for i=0,15 do
		for j=0,16 do
			--spr(rnd(bg_id),i*8,j*8-(player_y%8))
			spr(0,i*8,j*8+ofs-8)
		end
	end
end

function draw_o(o)
	spr(o.n,o.x,o.y)
end

function draw_obstacles()
	for i,o in pairs(o_list) do
		draw_o(o)
	end
end

function draw_player()
	if player_crash then
		spr(67,player_x,player_y)
	else
	 spr(player_n,player_x,player_y)
 end
end
-->8
--update game
function _update60()
	update_game()
end

t=0
function update_game()
	--set_speed()
	if player_crash then
		player_speed = 0
	else
	 input()
	end
	move_player()
	update_obstacles()
	if rnd(100) > 90 then
		add_object()
	end
	
	t+=1
end

function set_speed()
	if t > 10000 then
		player_speed *= 2
		t = 0
	end
end

acc = 1.05
function input()
	--0 is left
	if btn(0) then
		player_x -= 1
		player_n = 65
		if player_speed > player_turnspeed then
			player_speed /= acc
		end
	--1 is right
	elseif btn(1) then
		player_x += 1
		player_n = 66
		if player_speed > player_turnspeed then
			player_speed /= acc
		end
	else
		player_n = 64
		if player_speed < player_maxspeed then
			player_speed *= acc
		end
	end
end

function move_player()
	--player_y += player_speed
end

function update_obstacles()
	for i,o in pairs(o_list) do
		o.y -= player_speed
		if o.y > player_y and o.y < player_y + 8 and
	    o.x > player_x and o.x < player_x + 8 then
	  player_crash = true
	  player_maxspeed = 0
	 end
		
		if o.y + 8 < 0 then
			del(o_list,o)
		end
	end
end

o_id = {16,17,18}
function add_object()
	o = new_o(rnd(o_id),rnd(128),128)
	add(o_list, o)
end


-->8
--game over
function draw_gameover()

end

function update_gameover()

end
__gfx__
66666666666666666666666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
67666666676666666666666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666666666666666666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666666666666666666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666766666666666666666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666666666666666666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666666666666666766600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
66666666666666666666666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000400000007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004440000007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00004044044444000077700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00444440444244400077700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ff44400044282440077bb30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000004000218620007bbb30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000040081888007bbbbb3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000ee0000ee0700000070ee000e00e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
009ff9000ff9000770009ff00e1001e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
009ff9000ff9997007999ff0e001100e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09999990001119000091110000099000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
79111197000e110ee011e00000999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0710017000e001e00e100e000909f090000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00e00e0000e00e0000e00e000909f090000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00e00e000000e000000e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
311000000f0500f05012050140501605014050120500f0501c050000000000000000180500000000000000001105012050140500f050120500f0500d0500f0501505011000000000000011050000000000000000
19160000180531c0501f054180501c0501f054180501c0511c0501f050230541f050230501c0541f050210511f05323050260541f05023050260541f05028052170501305217054180501c053170541c0501f051
b716000028250185463c6551854524350000003c6550000000000000003c6551854500000000003c655000002b250185463c6551854528450000003c6550000000000000003c65518545000003c6551c3501d450
b91600000025000000000000025500250000000000000250042500000000000000000425504250000000000005250000000000005255052500000000000052570725000000000000725007255052500525504250
011600001d0511f0551c055210551d0551f0551c055210551d0551f0551c055210551d0551f0551c051210552b0512d055290552b0552b0552d055290552b0552d0552905528055260552d055290552805126055
b51600200c15324655000002465500000246550000024655000002465500000246550c1532465500000246550c15324655000002465500000246550000024655000002465500000246550c153246550000024655
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00040000276102c62038630346402e640246301b63015620116200b61008610036100260001600006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__music__
00 02030444
00 05064344


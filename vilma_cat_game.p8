pico-8 cartridge // http://www.pico-8.com
version 41
__lua__
function _init()
	--camera position
	cx=0
	cy=0
	--init cat position
	px=64
	py=3
	--init bee
	init_bees()
end

function _draw()
	cls(3)
	map(0,0,-cx,-cy)
	spr(1,px-cx,py-cy)--cat player
	--draw all bees
	for bee in all(bees) do
		bee:draw()
	end
end

function _update()
	input()
	--update bees
	for bee in all(bees) do
		bee:update()
	end
end

function input()
	if btn(⬅️) then
		px-=1
	end
	if btn(➡️) then
		px+=1
	end
	if btn(⬆️) then
 	py-=1
	end
	if btn(⬇️) then
	 py+=1
	end
	cx=px-64
	cy=py-64
end
-->8
--enemy
function init_bees()
	bees={}
	for i=0,30 do
		add(bees,new_bee(flr(rnd(128)),flr(rnd(128))))
	end
end

bee_speed=0.1--bee speed
bee_fr=8--flower radius
bee_pr=4--player radius
function new_bee(x,y)
	bee={}
	bee.n=17
	bee.x=x
	bee.y=y
	bee.tx=nil
	bee.ty=nil
	--search flower in radius
	--"search"
	--goto flower in radius
	--"going"
	--pollinate flower
	--"found"
	--attack player
	--"angry"
	bee.state="search"
	
	bee.draw=function(this)
		spr(this.n,this.x-cx,this.y-cy)
	end
	
	bee.update=function(this)
		local mx=flr(this.x/8)
		local my=flr(this.y/8)
		
		if this.state=="search" then
			this.x+=rnd(1)-0.5
			this.y+=rnd(1)-0.5
			
			for	i=0,bee_fr do 
				for	j=0,bee_fr do
					local sx=mx-bee_fr
					local sy=my-bee_fr 
					--found a flower to go to!:d
					if mget(sx+i,sy+j)==64 then
						this.state="going"
						this.tx=8*(sx+i)
						this.ty=8*(sy+j)
					end
				end
			end
			
		elseif this.state=="going" then
			local dx=this.x-this.tx
			local dy=this.y-this.ty
			local angle=atan2(dx,dy)
			
			if this.x!=this.ty then
			
			end
		
		elseif this.state=="found" then
		
		
		
		elseif this.state=="angry" then
			this.x+=rnd(1)-0.5
			this.y+=rnd(1)-0.5
		end
		
		
	end
	
	return bee
end


__gfx__
00000000005050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000051515000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700077e77000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000077777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700000dddd000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700707775000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000777775550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000077777050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000aaa1a1a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000008a81a1a10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000aaa1a1a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eae00dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0e00daad000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000daad000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a000dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
a4a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0040404040000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040400000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000040400040400000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4000000000000000000000000040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0040000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000400000000000000000004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000040400040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000400040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
